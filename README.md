# Artifex Server

åŸºäº NestJS çš„åç«¯APIæœåŠ¡ï¼Œæä¾›ç”¨æˆ·è®¤è¯å’Œç®¡ç†åŠŸèƒ½ã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ NestJS æ¡†æ¶æ„å»ºçš„ç°ä»£åŒ–åç«¯æœåŠ¡ï¼Œé›†æˆäº†JWTè®¤è¯ã€æ•°æ®éªŒè¯ã€é…ç½®ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸš€ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: NestJS 11.x
- **è¯­è¨€**: TypeScript
- **è®¤è¯**: JWT (JSON Web Token)
- **éªŒè¯**: Class-validator & Class-transformer
- **éƒ¨ç½²**: PM2
- **æµ‹è¯•**: Jest

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
artifex-server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ auth/              # è®¤è¯æœåŠ¡
â”‚   â”‚   â””â”€â”€ auth.service.ts
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ dto/               # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â””â”€â”€ login.dto.ts
â”‚   â”œâ”€â”€ entities/          # å®ä½“ç±»
â”‚   â”œâ”€â”€ examples/          # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ prisma/            # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ repositories/      # æ•°æ®ä»“åº“
â”‚   â”œâ”€â”€ app.controller.ts  # åº”ç”¨æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ app.module.ts      # åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ main.ts           # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ user.controller.ts # ç”¨æˆ·æ§åˆ¶å™¨
â”œâ”€â”€ test/                  # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ ecosystem.config.js    # PM2 é…ç½®
â””â”€â”€ package.json
```

## ğŸ› ï¸ å®‰è£…ä¸è¿è¡Œ

### å‰ç½®è¦æ±‚

- Node.js >= 16
- npm æˆ– yarn

### å®‰è£…ä¾èµ–

```bash
npm install
```

### ç¯å¢ƒé…ç½®

åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```env
# ç«¯å£é…ç½®
PORT=3000

# JWTé…ç½®
JWT_SECRET=your-jwt-secret-key

# å…¶ä»–é…ç½®é¡¹...
```

### å¼€å‘ç¯å¢ƒè¿è¡Œ

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run start:dev

# è°ƒè¯•æ¨¡å¼
npm run start:debug

# æ™®é€šå¯åŠ¨
npm run start
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# æ„å»ºé¡¹ç›®
npm run build

# PM2éƒ¨ç½²ï¼ˆæ¨èï¼‰
npm run start:pm2

# æˆ–ç›´æ¥è¿è¡Œ
npm run start:prod
```

## ğŸ“š API æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

- **åŸºç¡€URL**: `http://localhost:3000`
- **è®¤è¯æ–¹å¼**: JWT Bearer Token

### è®¤è¯ç›¸å…³

#### ç”¨æˆ·ç™»å½•

```http
POST /api/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

**å“åº”ç¤ºä¾‹:**

```json
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "user": {
      "id": 1,
      "username": "admin"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

### æµ‹è¯•è´¦æˆ·

é¡¹ç›®æä¾›ä»¥ä¸‹æµ‹è¯•è´¦æˆ·ï¼š

| ç”¨æˆ·å | å¯†ç  | è§’è‰² |
|--------|------|------|
| admin  | admin123 | ç®¡ç†å‘˜ |
| user   | user123  | æ™®é€šç”¨æˆ· |

## ğŸ§ª æµ‹è¯•

```bash
# å•å…ƒæµ‹è¯•
npm run test

# ç›‘å¬æ¨¡å¼æµ‹è¯•
npm run test:watch

# æµ‹è¯•è¦†ç›–ç‡
npm run test:cov

# E2Eæµ‹è¯•
npm run test:e2e
```

## ğŸ”§ å¼€å‘å·¥å…·

### ä»£ç æ ¼å¼åŒ–

```bash
# æ ¼å¼åŒ–ä»£ç 
npm run format

# ä»£ç æ£€æŸ¥
npm run lint
```

### æ„å»º

```bash
# æ„å»ºé¡¹ç›®
npm run build
```

## ğŸ“ ä¸»è¦åŠŸèƒ½

### ğŸ” è®¤è¯ç³»ç»Ÿ

- JWT Token è®¤è¯
- ç”¨æˆ·ç™»å½•éªŒè¯
- Token æœ‰æ•ˆæœŸç®¡ç†ï¼ˆ24å°æ—¶ï¼‰

### âœ… æ•°æ®éªŒè¯

- ä½¿ç”¨ Class-validator è¿›è¡Œè¯·æ±‚æ•°æ®éªŒè¯
- å…¨å±€éªŒè¯ç®¡é“é…ç½®
- è‡ªåŠ¨ç±»å‹è½¬æ¢

### âš™ï¸ é…ç½®ç®¡ç†

- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
- å…¨å±€é…ç½®æœåŠ¡
- å¤šç¯å¢ƒé…ç½®æ”¯æŒ

## ğŸš€ éƒ¨ç½²è¯´æ˜

### PM2 é…ç½®

é¡¹ç›®ä½¿ç”¨ PM2 è¿›è¡Œç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼Œé…ç½®å¦‚ä¸‹ï¼š

- **åº”ç”¨åç§°**: artifexServer
- **å®ä¾‹æ•°é‡**: 2
- **ç«¯å£**: 12600
- **å†…å­˜é™åˆ¶**: 1GB
- **è‡ªåŠ¨é‡å¯**: å¯ç”¨

### ç¯å¢ƒè¦æ±‚

- Node.js 16+
- PM2 (ç”Ÿäº§ç¯å¢ƒ)
- è¶³å¤Ÿçš„å†…å­˜å’ŒCPUèµ„æº

## ğŸ“„ è®¸å¯è¯

UNLICENSED

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è®¿é—®ï¼š[https://linlifeng.top](https://linlifeng.top)

---

**æ³¨æ„**: å½“å‰é¡¹ç›®ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œç”Ÿäº§ç¯å¢ƒè¯·æ›¿æ¢ä¸ºçœŸå®çš„æ•°æ®åº“å®ç°ã€‚
